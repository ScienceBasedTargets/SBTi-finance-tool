<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SBTi.utils &mdash; SBTi Temperature Alignment tool  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> SBTi Temperature Alignment tool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction to temperature scoring and portfolio coverage methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started Using Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rest_api.html">Getting Started Using REST API &amp; UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../FunctionalOverview.html">Functional Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../DataRequirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Legends.html">Data Legends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../links.html">Project Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../terms.html">Terms of Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SBTi Temperature Alignment tool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">SBTi.utils</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/SBTi/utils/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-SBTi.utils">
<span id="sbti-utils"></span><h1><a class="reference internal" href="#module-SBTi.utils" title="SBTi.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">SBTi.utils</span></code></a><a class="headerlink" href="#module-SBTi.utils" title="Permalink to this headline"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils.get_data_providers" title="SBTi.utils.get_data_providers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data_providers</span></code></a>(data_providers_configs: List[dict], data_providers_input: List[str]) → List[SBTi.data.DataProvider]</p></td>
<td><p>Determines which data provider and in which order should be used.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#SBTi.utils.get_company_data" title="SBTi.utils.get_company_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_company_data</span></code></a>(data_providers: list, company_ids: List[str]) → List[SBTi.interfaces.IDataProviderCompany]</p></td>
<td><p>Get the company data in a waterfall method, given a list of companies and a list of data providers. This will go</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils.get_targets" title="SBTi.utils.get_targets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_targets</span></code></a>(data_providers: list, companies: list) → List[SBTi.interfaces.IDataProviderTarget]</p></td>
<td><p>Get the targets in a waterfall method, given a list of companies and a list of data providers. This will go through</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#SBTi.utils._flatten_user_fields" title="SBTi.utils._flatten_user_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_flatten_user_fields</span></code></a>(record: SBTi.interfaces.PortfolioCompany)</p></td>
<td><p>Flatten the user fields in a portfolio company and return it as a dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils._make_id_map" title="SBTi.utils._make_id_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_make_id_map</span></code></a>(df_portfolio: pandas.DataFrame) → dict</p></td>
<td><p>Create a mapping from company_id to ISIN and LEI (required for the SBTi matching).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#SBTi.utils.dataframe_to_portfolio" title="SBTi.utils.dataframe_to_portfolio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataframe_to_portfolio</span></code></a>(df_portfolio: pandas.DataFrame) → List[SBTi.interfaces.PortfolioCompany]</p></td>
<td><p>Convert a data frame to a list of portfolio company objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils.merge_target_data" title="SBTi.utils.merge_target_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_target_data</span></code></a>(provider_targets: List[SBTi.interfaces.IDataProviderTarget], sbti_targets: Dict[str, List[SBTi.interfaces.IDataProviderTarget]]) → List[SBTi.interfaces.IDataProviderTarget]</p></td>
<td><p>Merge targets from data providers with SBTi targets, preferring SBTi data for validated companies.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#SBTi.utils.get_data" title="SBTi.utils.get_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_data</span></code></a>(data_providers: List[SBTi.data.DataProvider], portfolio: List[SBTi.interfaces.PortfolioCompany], reporting_date: Optional[datetime.datetime] = None) → pandas.DataFrame</p></td>
<td><p>Get the required data from the data provider(s), validate the targets and return a 9-box grid for each company.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils.calculate" title="SBTi.utils.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>(portfolio_data: pandas.DataFrame, fallback_score: float, aggregation_method: SBTi.portfolio_aggregation.PortfolioAggregationMethod, grouping: Optional[List[str]], scenario: Optional[SBTi.temperature_score.Scenario], time_frames: List[SBTi.interfaces.ETimeFrames], scopes: List[SBTi.interfaces.EScope], anonymize: bool, aggregate: bool = True) → Tuple[pandas.DataFrame, Optional[SBTi.interfaces.ScoreAggregations]]</p></td>
<td><p>Calculate the different parts of the temperature score (actual scores, aggregations, column distribution).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#SBTi.utils.DATA_PROVIDER_MAP" title="SBTi.utils.DATA_PROVIDER_MAP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DATA_PROVIDER_MAP</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py data">
<dt class="sig sig-object py" id="SBTi.utils.DATA_PROVIDER_MAP">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">DATA_PROVIDER_MAP</span></span><em class="property"><span class="w"> </span><span class="pre">:Dict[str,</span> <span class="pre">Type[SBTi.data.DataProvider]]</span></em><a class="headerlink" href="#SBTi.utils.DATA_PROVIDER_MAP" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.get_data_providers">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">get_data_providers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_providers_configs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_providers_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../data/index.html#SBTi.data.DataProvider" title="SBTi.data.DataProvider"><span class="pre">SBTi.data.DataProvider</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.get_data_providers" title="Permalink to this definition"></a></dt>
<dd><p>Determines which data provider and in which order should be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_providers_configs</strong> – A list of data provider configurations</p></li>
<li><p><strong>data_providers_input</strong> – A list of data provider names</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of data providers in order.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.get_company_data">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">get_company_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_providers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">company_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.IDataProviderCompany" title="SBTi.interfaces.IDataProviderCompany"><span class="pre">SBTi.interfaces.IDataProviderCompany</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.get_company_data" title="Permalink to this definition"></a></dt>
<dd><p>Get the company data in a waterfall method, given a list of companies and a list of data providers. This will go
through the list of data providers and retrieve the required info until either there are no companies left or there
are no data providers left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_providers</strong> – A list of data providers instances</p></li>
<li><p><strong>company_ids</strong> – A list of company ids (ISINs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A data frame containing the company data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.get_targets">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_providers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">companies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.IDataProviderTarget" title="SBTi.interfaces.IDataProviderTarget"><span class="pre">SBTi.interfaces.IDataProviderTarget</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.get_targets" title="Permalink to this definition"></a></dt>
<dd><p>Get the targets in a waterfall method, given a list of companies and a list of data providers. This will go through
the list of data providers and retrieve the required info until either there are no companies left or there are no
data providers left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_providers</strong> – A list of data providers instances</p></li>
<li><p><strong>companies</strong> – A list of companies. Each company should be a dict and contain a company_name and company_id field</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A data frame containing the targets</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils._flatten_user_fields">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">_flatten_user_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.PortfolioCompany" title="SBTi.interfaces.PortfolioCompany"><span class="pre">SBTi.interfaces.PortfolioCompany</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SBTi.utils._flatten_user_fields" title="Permalink to this definition"></a></dt>
<dd><p>Flatten the user fields in a portfolio company and return it as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> – The record to flatten</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils._make_id_map">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">_make_id_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_portfolio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#SBTi.utils._make_id_map" title="Permalink to this definition"></a></dt>
<dd><p>Create a mapping from company_id to ISIN and LEI (required for the SBTi matching).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df_portfolio</strong> – The complete portfolio</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A mapping from company_id to (ISIN, LEI) tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.dataframe_to_portfolio">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">dataframe_to_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_portfolio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.PortfolioCompany" title="SBTi.interfaces.PortfolioCompany"><span class="pre">SBTi.interfaces.PortfolioCompany</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.dataframe_to_portfolio" title="Permalink to this definition"></a></dt>
<dd><p>Convert a data frame to a list of portfolio company objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df_portfolio</strong> – The data frame to parse. The column names should align with the attribute names of the</p>
</dd>
</dl>
<p>PortfolioCompany model.
:return: A list of portfolio companies</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.merge_target_data">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">merge_target_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">provider_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.IDataProviderTarget" title="SBTi.interfaces.IDataProviderTarget"><span class="pre">SBTi.interfaces.IDataProviderTarget</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbti_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.IDataProviderTarget" title="SBTi.interfaces.IDataProviderTarget"><span class="pre">SBTi.interfaces.IDataProviderTarget</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.IDataProviderTarget" title="SBTi.interfaces.IDataProviderTarget"><span class="pre">SBTi.interfaces.IDataProviderTarget</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.merge_target_data" title="Permalink to this definition"></a></dt>
<dd><p>Merge targets from data providers with SBTi targets, preferring SBTi data for validated companies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>provider_targets</strong> – List of targets from data providers</p></li>
<li><p><strong>sbti_targets</strong> – Dictionary mapping company_id to list of SBTi targets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Merged list of targets</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.get_data">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_providers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../data/index.html#SBTi.data.DataProvider" title="SBTi.data.DataProvider"><span class="pre">SBTi.data.DataProvider</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portfolio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.PortfolioCompany" title="SBTi.interfaces.PortfolioCompany"><span class="pre">SBTi.interfaces.PortfolioCompany</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reporting_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span></span></span><a class="headerlink" href="#SBTi.utils.get_data" title="Permalink to this definition"></a></dt>
<dd><p>Get the required data from the data provider(s), validate the targets and return a 9-box grid for each company.
Enhanced to use SBTi authoritative target data when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_providers</strong> – A list of DataProvider instances</p></li>
<li><p><strong>portfolio</strong> – A list of PortfolioCompany models</p></li>
<li><p><strong>reporting_date</strong> – Optional reporting date for target validation and time-frame classification.
Per the CDP/WWF V1 Temperature Rating Methodology (Section 2.1.4), time frames are “forward looking”
relative to the reporting year. When provided:
- Target validation checks end year against reporting_date instead of today
- Time-frame classification (short/mid/long) is calculated relative to reporting_date
When None, defaults to today’s date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A data frame containing the relevant company-target data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SBTi.utils.calculate">
<span class="sig-prename descclassname"><span class="pre">SBTi.utils.</span></span><span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolio_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../portfolio_aggregation/index.html#SBTi.portfolio_aggregation.PortfolioAggregationMethod" title="SBTi.portfolio_aggregation.PortfolioAggregationMethod"><span class="pre">SBTi.portfolio_aggregation.PortfolioAggregationMethod</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">grouping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scenario</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../temperature_score/index.html#SBTi.temperature_score.Scenario" title="SBTi.temperature_score.Scenario"><span class="pre">SBTi.temperature_score.Scenario</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.ETimeFrames" title="SBTi.interfaces.ETimeFrames"><span class="pre">SBTi.interfaces.ETimeFrames</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scopes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.EScope" title="SBTi.interfaces.EScope"><span class="pre">SBTi.interfaces.EScope</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anonymize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../interfaces/index.html#SBTi.interfaces.ScoreAggregations" title="SBTi.interfaces.ScoreAggregations"><span class="pre">SBTi.interfaces.ScoreAggregations</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#SBTi.utils.calculate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the different parts of the temperature score (actual scores, aggregations, column distribution).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>portfolio_data</strong> – The portfolio data, already processed by the target validation module</p></li>
<li><p><strong>fallback_score</strong> – The fallback score to use while calculating the temperature score</p></li>
<li><p><strong>aggregation_method</strong> – The aggregation method to use</p></li>
<li><p><strong>time_frames</strong> – The time frames that the temperature scores should be calculated for  (None to calculate all)</p></li>
<li><p><strong>scopes</strong> – The scopes that the temperature scores should be calculated for (None to calculate all)</p></li>
<li><p><strong>grouping</strong> – The names of the columns to group on</p></li>
<li><p><strong>scenario</strong> – The scenario to play</p></li>
<li><p><strong>anonymize</strong> – Whether to anonymize the resulting data set or not</p></li>
<li><p><strong>aggregate</strong> – Whether to aggregate the scores or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The scores, the aggregations and the column distribution (if a</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Science Based Targets.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>